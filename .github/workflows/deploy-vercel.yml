name: Vercel Deploy Hook

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read

jobs:
  deploy:
    name: Trigger Vercel Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Invoke Vercel deploy hook
        env:
          HOOK_URL: ${{ secrets.VERCEL_DEPLOY_HOOK_URL }}
        shell: bash
        run: |
          if [ -z "$HOOK_URL" ]; then
            echo "::error::Repository secret VERCEL_DEPLOY_HOOK_URL is not set."
            echo "Add it at Settings → Secrets and variables → Actions → New repository secret."
            exit 1
          fi
          echo "Triggering Vercel deploy hook…"
          curl -fsS -X POST "$HOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{}'
          echo "Hook invoked"
