<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Access · NewsPulse</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 2rem; max-width: 560px; margin: 0 auto; }
      .card { border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; box-shadow: 0 1px 2px rgba(0,0,0,0.04); }
      label { display:block; font-weight:600; margin-bottom: .5rem; }
      input[type=email]{ width:100%; padding:.75rem 1rem; border:1px solid #d1d5db; border-radius:8px; }
      button{ margin-top:1rem; padding:.75rem 1rem; border:none; background:#111827; color:#fff; border-radius:8px; cursor:pointer; }
      .muted{ color:#6b7280; font-size:.875rem; }
      .link{ word-break: break-all; }
    </style>
  </head>
  <body>
    <h1>Request Admin Link</h1>
    <p class="muted">Enter your approved email to receive a one-time magic link. In this demo, we will display the link directly.</p>
    <div class="card">
      <form id="form">
        <label for="email">Email</label>
        <input id="email" type="email" placeholder="you@company.com" required />
        <button type="submit">Get magic link</button>
      </form>
      <div id="result" style="margin-top:1rem"></div>
    </div>

    <script>
      const form = document.getElementById('form');
      const result = document.getElementById('result');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        result.textContent = 'Requesting…';
        const email = document.getElementById('email').value;
        try {
          const r = await fetch('/api/admin-auth/start', {
            method: 'POST',
            headers: {'content-type':'application/json'},
            body: JSON.stringify({ email })
          });
          const data = await r.json();
          if (!r.ok) throw new Error(data.error || 'Request failed');
          result.innerHTML = `<div>Success. Click your magic link to continue:</div><div class="link"><a href="${data.link}">${data.link}</a></div>`;
        } catch (err) {
          result.textContent = 'Error: ' + err.message;
        }
      });
    </script>
  </body>
</html>
